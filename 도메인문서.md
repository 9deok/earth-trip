## 도메인 문서 (Earth Trip)

목적: 구현 세부(데이터 모델, API 등)를 제외하고, 도메인 개념/정책/UX 원칙만 정리합니다. 이 문서는 기획 및 코드 작성 시 공통 기준점입니다.

---

## 도메인 원칙

- 핵심 가치: 계획·실행 중심, 기록(일기)과 수집(클리핑)으로 폐곡선 형성
- 맥락 유지: 여행 단위(Trip) ↔ 일자 단위(Day) ↔ 아이템(Item) 계층 보존
- 짧고 자주: 일기는 사진/글자 수 제한으로 작성 허들을 낮춘다
- 가시성 우선순위: 기본 private, 명시적 공개 전환 시에만 외부 노출

---

## 핵심 유스케이스

- 여행 생성/편집/공유(링크) 및 일자/아이템 관리(추가/정렬/완료)
- 일자별 일기 작성(감정 점수 포함)과 여행별 총 회고 작성
- 감정선 확인 및 “가장 감정이 좋았던 여행” 탐색
- 클리핑을 여행/일자에 삽입하여 계획으로 전환

---

## 공개/비공개 및 소셜 정책

- 가시성: private이 기본. public 전환 시 홈/공유 링크로 노출 가능
- 공개 항목에만 좋아요/댓글/조회수 노출. 카운터는 서버 원천, 클라 읽기 전용
- 조회수는 상세 진입 시 증가(중복/로봇 필터링은 서버 책임)

---

## 일기 탭 UX/도메인 상세

목적

- 여행 단위의 맥락(총 회고)과 일자 단위의 감정/메모 기록을 “짧고 자주” 남기게 한다.
- 시각화(감정선)로 여행의 분위기 변화를 한눈에 제공한다.

콘텐츠 유형

- 일자별 일기(Daily Diary): 사진 최대 1장, 본문 최대 300자, 감정 점수(1–5)
- 여행 총 회고(Trip Retrospective): 사진 최대 3장, 본문 최대 1500자

UI 구성(요약)

- 일기 탭 메인
  - 상단: 월 선택(YYYY-MM), CTA “오늘의 일기 쓰기”
  - 하이라이트: “가장 행복했던 여행” 카드(평균 감정 Top1 + 미니 감정선)
  - 여행 묶음 카드 리스트: 여행 헤더(제목/기간/일수) + 탭(일자별/총 회고) + 미니 감정선 + 최근 3개 일자 카드 스냅샷 + “더 보기”
- 여행 상세 일기 뷰(블로그형)
  - 히어로: 커버/요약/평균·최고 감정
  - 감정선 그래프(일자별 점수, min/max/avg 표시)
  - 일자 섹션을 세로로 연속 노출(사진≤1, 300자 제한, 태그/위치/날씨 옵션)
  - 하단 고정 바: “일자 추가”, “총 회고 쓰기”, “형태 유지 복사”
- 총 회고 뷰
  - 사진≤3 갤러리 + 본문≤1500자 + 공개/비공개 토글

작성 플로우(일자)

- 바텀시트: 날짜(기본 오늘) → 감정(이모지 1–5 슬라이더) → 사진 0–1 → 본문(남은 글자수 카운터)
- 저장 시 글자수/사진 제한을 클라이언트에서 선제 검증

복사/내보내기(블로그 게시 지원)

- 출력 포맷: Markdown 또는 HTML(간단 CSS 인라인). 사용자가 선택
- 구성: 여행 제목(H2) → 요약 → 감정선 이미지 → 일자 섹션 반복(날짜/감정/텍스트/사진)
- 기능: “클립보드로 복사”, “파일로 내보내기(.md/.html)”

감정선 그래프 스펙

- X축: DayIndex, Y축: 1~5
- 시각 요소: 최고/최저 day 강조, 평균선 점선, 미작성 구간은 회색 점선
- 라이브러리 제안: fl_chart

가장 감정이 좋았던 여행 산정

- 기본: 평균 감정 점수(작성된 일자만) 내림차순
- 보정: 표준편차가 큰 여행은 가중치 감소(안정성 가점). 동점 시 최신성/일수 커버율 우선

공개/상호작용

- 기본 private, 공개 전환 시 경고 다이얼로그(검색/링크 노출 안내)
- 공개 항목에 한해 좋아요/댓글/조회수 노출(카운터는 서버 원천)

검증 규칙(수행 기준)

- Daily: 사진 ≤1, 글자 ≤300, moodScore ∈ [1,5]
- Retrospective: 사진 ≤3, 글자 ≤1500
- 서버 검증 실패 시 필드별 오류 표시, 클라이언트는 저장 전 하드 제한

분석 이벤트(예)

- diary_create, diary_edit, diary_publish_toggle
- retrospective_create, retrospective_publish_toggle
- mood_chart_view, best_trip_view
- export_copy_html, export_copy_md

---

## 용어 정의(확장)

- Trip: 여행 단위의 집합체. Day/Item을 포함하고 가시성(visibility)을 가진다.
- TripDay: 여행의 일자 단위(D1…). 특정 date와 그날의 Item 목록을 가진다.
- TripItem: 일자 타임라인의 원자 단위(PLACE/MOVE/FOOD/NOTE/BOOKING). 완료 여부(done)를 갖는다.
- DiaryEntry: 일자별 기록. 사진≤1, 글≤300, moodScore(1~5), 여행/일자 연결 가능.
- TripRetrospective: 여행 전체 회고. 사진≤3, 글≤1500. 공개/비공개 가능.
- ClippingItem: 외부에서 저장한 링크/메모. 특정 여행/일자/시간에 삽입 가능.
- MoodScore: 정수 1~5. 감정선 그래프의 Y값.
- Emotion Curve(감정선): 여행 기간 동안 moodScore의 시계열.
- Visibility: private/public. 기본은 private.
- PublicSlug: 공개 여행의 공유용 슬러그.
- Favorite: 사용자가 즐겨찾기한 여행 상태.
- Status: 여행 진행 상태(planning/ongoing/done).
- Tag: 자유 태그 문자열. 탐색·분류용.
- Money: 통화/금액 값 객체. 비용 표기 시 사용.
- Location: 장소명/주소/좌표를 포함할 수 있는 값 객체.
- Weather: 요약/아이콘 URL 등 간단 날씨 정보.
- Timeline: TripDay 내 Item들의 시간순 배열.
- Publish/Unpublish: 공개 전환/해제 행위.
- Best Trip: 평균 moodScore가 가장 높은 여행(보정 규칙 고려).
- Coverage Rate: 일자 중 기록이 존재하는 비율. 랭킹 보조 지표.
- Export Copy: 블로그 게시용 Markdown/HTML 생성 및 복사 기능.
